{
  "$schema": "https://opencode.ai/config.json",
  "agent": {
    "analysis": {
      "description": "Analyze code for potential issues, vulnerabilities and improvements",
      "prompt": "{file:./prompts/AGENTS.md}",
      "mode": "primary",
      "model": "{{ .Provider }}/{{ .Model }}",
      "temperature": 0.1,
      "tools": {
        "plural*": true,
      },
      "permission": {
        "bash": {
          "ls": "allow",
          "cd": "allow",
          "pwd": "allow",
          "git status": "allow",
          "git diff": "allow",
          "head": "allow",
          "tail": "allow",
          "cat": "allow",
          "grep": "allow",
          "find": "allow",
          "*": "deny"
        },
        "edit": "deny",
        "webfetch": "allow"
      }
    },
    "autonomous": {
      "description": "Autonomous agent for making code changes and creating pull requests",
      "prompt": "{file:./prompts/AGENTS.md}",
      "mode": "primary",
      "model": "{{ .Provider }}/{{ .Model }}",
      "temperature": 0.3,
      "tools": {
        "plural*": true,
        "write": false,
        "todowrite": false,
        "edit": false
      },
      "permission": {
        "bash": "allow",
        "edit": "allow",
        "webfetch": "allow"
      }
    }
  },
  "mcp": {
    "plural": {
      "type": "local",
      "command": ["mcpserver"],
      "enabled": true,
      "environment": {
        "PLRL_CONSOLE_TOKEN": "{{ .ConsoleToken }}",
        "PLRL_CONSOLE_URL": "{{ .ConsoleURL }}",
        "PLRL_AGENT_RUN_ID": "{{ .AgentRunID }}",
        {{ if eq .Model "WRITE" }}
        "PLRL_EXCLUDE_TOOLS": "updateAgentRunAnalysis"
        {{ else }}
        "PLRL_EXCLUDE_TOOLS": "createBranch,agentPullRequest,fetchAgentRunTodos,updateAgentRunTodos"
        {{ end }}
      }
    }
  },
  "username": "plural",
  "provider": {
    "plural": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "plural",
      "options": {
        "baseURL": "{{ .ConsoleURL }}/ext/ai/openai/v1",
        "headers": {
          "Authorization": "Bearer {{ .DeployToken }}"
        }
      },
      "models": {
        "gpt-4.1": {
          "name": "gpt-4.1",
          "reasoning": false
        },
        "gpt-5": {
          "name": "gpt-5",
          "reasoning": true,
          "options": {
            "reasoningEffort": "medium",
            "textVerbosity": "medium",
            "reasoningSummary": "auto"
          }
        },
        "gpt-5.1": {
          "name": "gpt-5.1",
          "reasoning": true,
          "options": {
            "reasoningEffort": "medium",
            "textVerbosity": "medium",
            "reasoningSummary": "auto"
          }
        },
        "gpt-5.2": {
          "name": "gpt-5.2",
          "reasoning": true,
          "options": {
            "reasoningEffort": "medium",
            "textVerbosity": "medium",
            "reasoningSummary": "auto"
          }
        }
      }
    }{{ if ne .Provider "plural" }},
    "{{ .Provider }}": {
      "name": "{{ .Provider }}",
      "options": {
        "baseURL": "{{ .Endpoint }}",
        "apiKey": "{{ .Token }}"
      },
      "models": {
        "gpt-4.1": {
          "name": "gpt-4.1",
          "reasoning": false
        },
        "gpt-5": {
          "name": "gpt-5",
          "reasoning": true,
          "options": {
            "reasoningEffort": "medium",
            "textVerbosity": "medium",
            "reasoningSummary": "auto"
          }
        },
        "gpt-5.1": {
          "name": "gpt-5.1",
          "reasoning": true,
          "options": {
            "reasoningEffort": "medium",
            "textVerbosity": "medium",
            "reasoningSummary": "auto"
          }
        },
        "gpt-5.2": {
          "name": "gpt-5.2",
          "reasoning": true,
          "options": {
            "reasoningEffort": "medium",
            "textVerbosity": "medium",
            "reasoningSummary": "auto"
          }
        }
      }
    }
    {{ end }}
  }
}